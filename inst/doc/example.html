<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Example scenarios</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example scenarios</h1>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#example-data" id="toc-example-data">Example data</a></li>
<li><a href="#activities" id="toc-activities">Activities</a>
<ul>
<li><a href="#activity-probability-and-transition-probabilities" id="toc-activity-probability-and-transition-probabilities">Activity
probability and transition probabilities</a></li>
<li><a href="#final-felling" id="toc-final-felling">Final
felling</a></li>
<li><a href="#no-management" id="toc-no-management">No management</a>
<ul>
<li><a href="#estimation-of-transition-matrix-using-pair-data" id="toc-estimation-of-transition-matrix-using-pair-data">Estimation of
transition matrix using pair data</a>
<ul>
<li><a href="#state-space" id="toc-state-space">State space</a></li>
<li><a href="#prior" id="toc-prior">Prior</a></li>
<li><a href="#estimation" id="toc-estimation">Estimation</a></li>
</ul></li>
</ul></li>
<li><a href="#thinning" id="toc-thinning">Thinning</a></li>
</ul></li>
<li><a href="#scenario-1" id="toc-scenario-1">Scenario 1</a>
<ul>
<li><a href="#analysing-results" id="toc-analysing-results">Analysing
results</a>
<ul>
<li><a href="#result-coefficients" id="toc-result-coefficients">Result
coefficients</a></li>
<li><a href="#results" id="toc-results">Results</a></li>
</ul></li>
</ul></li>
<li><a href="#scenario-2" id="toc-scenario-2">Scenario 2</a></li>
<li><a href="#scenario-3---land-use-changes" id="toc-scenario-3---land-use-changes">Scenario 3 - Land use
changes</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>European Forestry Dynamics Model (EFDM) is a model for large scale
scenario analysis. The model is an area-based matrix model where forest
area is stratified with respect to, for example, use, management
strategy and development (growth). The model can consider also other
land uses, see Scenario 3. In a model run forest area moves in ‘a
matrix’ span with the stratifying factors.</p>
<p>The <code>efdm</code> package includes functions to</p>
<ul>
<li>define management activities</li>
<li>estimate transition probabilities</li>
<li>run an EFDM scenario</li>
</ul>
<p>and an example dataset for illustration purposes.</p>
<p>In this vignette, we demonstrate ‘efdm’ in running a scenario with
the example dataset. Typical workflow in a EFDM scenario analysis starts
with preparing the datasets required as an input. Preparing the datasets
is usually the most time consuming part of the scenario analysis, and
the work flow depends on the data available. Therefore, the preparation
is not explained in this vignette. However, the attached datasets offer
an example for preparing own datasets.</p>
<p>The <code>efdm</code> is loaded with</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(efdm)</span></code></pre></div>
<p>The following packages are used in this vignette to manipulate data
and plot results. However, the data manipulation and reporting the
results could be done using other packages or even outside the R
environment.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
</div>
<div id="example-data" class="section level1">
<h1>Example data</h1>
<p>In this vignette we are using <code>example</code>, a collection of
example datasets to describe working with <code>efdm</code>. The dataset
covers entire Finland and the initial state represents year 2016.
However, the dataset is a toy data which is meant for learning the model
concept.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">data</span>(example)</span></code></pre></div>
<p>In this example we have chosen</p>
<ul>
<li>a 5-year simulation step</li>
<li>age and total growing stock volume per hectare to present forest
state
<ul>
<li>age is classified into 5 year classes, starting from class 1 = 0-5
years, and ending at class 35 = 170+ years with all forests over 170
years old</li>
<li>volume is classified into 15 classes with class limits depending on
the dominant tree species and their growth pattern</li>
</ul></li>
<li>additional stratification variables defining different forest strata
are spatial region (North, Middle, South), soil type (Mineral, Peat) and
dominant tree species (spruce, other species)</li>
</ul>
</div>
<div id="activities" class="section level1">
<h1>Activities</h1>
<p>In EFDM forest management is represented by activities and activity
probabilities. In the first example we have three activities</p>
<ul>
<li>thinning (thin)</li>
<li>final felling (ff)</li>
<li>no management (noman)</li>
</ul>
<div id="activity-probability-and-transition-probabilities" class="section level2">
<h2>Activity probability and transition probabilities</h2>
<p>The activity probabilities (<code>actprob</code> below) are the
probabilities for applying a specific management activity in a specific
forest state described by the stratification variables. The activity
probabilities are used to allocate forest area to different activities.
A valid activity probability specifies activity probabilities for all
possible states and activities. All probabilities should be positive and
the sum of activity probabilities for each state should be 1.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>actprob <span class="ot">&lt;-</span> example<span class="sc">$</span>actprob</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>actprob</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;   region    soil    sp vol age noman  thin    ff</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 1  South Mineral other   1   1 0.976 0.023 0.001</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 2  South Mineral other   1   2 0.981 0.019 0.000</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 3  South Mineral other   1   3 0.994 0.006 0.000</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 4  South Mineral other   1   4 0.991 0.008 0.001</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 5  South Mineral other   1   5 0.764 0.024 0.212</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 6  South Mineral other   1   6 0.974 0.025 0.001</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 6294 rows ]</span></span></code></pre></div>
<p>Each activity has a transition probability matrix. The transition
probability describes movements of forest areas by the simulation time
steps. It is used to move a forest state to the next states. A valid
transition probability should specify transition probability for each
state where the activity can be used. For example if final felling only
applies to forests with some minimum volume, then there is no need to
specify transitions from states with less than the minimum volume.</p>
</div>
<div id="final-felling" class="section level2">
<h2>Final felling</h2>
<p>The final felling activity is represented by a transition matrix that
has probability 1 to move any forest to a state where volume and age are
in the smallest class.</p>
<p>The target state is independent of the starting state. It will always
be <code>vol=1</code> and <code>age=1</code>, the smallest class in the
stratification.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>transprobs_ff <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">vol0=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">age0=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>, <span class="at">vol1=</span><span class="dv">1</span>, <span class="at">age1=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>transprobs_ff</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;    vol0 age0 vol1 age1 prob</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 1     1    1    1    1    1</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 2     2    1    1    1    1</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 3     3    1    1    1    1</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 4     4    1    1    1    1</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 5     5    1    1    1    1</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 6     6    1    1    1    1</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 7     7    1    1    1    1</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; 8     8    1    1    1    1</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 9     9    1    1    1    1</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 10   10    1    1    1    1</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 515 rows ]</span></span></code></pre></div>
<p>In <code>efdm</code> the final felling activity is defined by
giving</p>
<ul>
<li>name of the activity, “ff”</li>
<li>names of the dynamic variables, that is the variables that the final
felling activity affects, “vol” and “age”</li>
<li>transition probabilities</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>ff <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;ff&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>), transprobs_ff)</span></code></pre></div>
</div>
<div id="no-management" class="section level2">
<h2>No management</h2>
<p>If there are no management activities or treatments in the forest,
“no management” activity is used to make the forest grow. In this
example, we assume that growth changes the values of volume and age and
is dependent on region, soil type and tree species. Moreover, we assume
that the growth is so different in between regions and tree species,
that it should be estimates completely separately for each class.</p>
<div id="estimation-of-transition-matrix-using-pair-data" class="section level3">
<h3>Estimation of transition matrix using pair data</h3>
<p>To estimate the transition matrix, we use “pair data” obtained from
two consecutive measurements of permanent sample plots in the national
forest inventory. For <code>estimatetransprobs</code>, the estimation
function implemented in <code>efdm</code>, the pair data is a
<code>data.frame</code> of pairs of dynamic variables and possible
stratification variables, which affect the growth but are not affected
by growth.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>example<span class="sc">$</span>noman_pairs</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;   region    soil     sp vol0 vol1 age0 age1</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 1  South Mineral spruce   10    7   13   14</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 2  South Mineral spruce    8    8   20   21</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 3  South Mineral  other    9   10    5    6</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 4  South Mineral  other    1    1    1    2</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 5  South Mineral  other    7    8    2    3</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 6  South Mineral  other    7   10    5    6</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 7  South Mineral  other    3    5   31   32</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 15535 rows ]</span></span></code></pre></div>
<p>In order to use <code>estimatetransprobs</code> we still need two
parts, a state space and a prior. The state space and prior are required
because the pair data might not have observations for all possible
states, but the transition matrix should be available for all
states.</p>
<div id="state-space" class="section level4">
<h4>State space</h4>
<p>The state space is the collection of all possible states of
stratifying variables. Since we have an activity probability for each
state we can use the <code>actprob</code> to obtain the
<code>statespace</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>statespace <span class="ot">&lt;-</span> actprob <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(region, soil, sp, vol, age))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>statespace</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;    region    soil    sp vol age</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; 1   South Mineral other   1   1</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; 2   South Mineral other   1   2</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; 3   South Mineral other   1   3</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 4   South Mineral other   1   4</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 5   South Mineral other   1   5</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 6   South Mineral other   1   6</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 7   South Mineral other   1   7</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 8   South Mineral other   1   8</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 9   South Mineral other   1   9</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; 10  South Mineral other   1  10</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 6290 rows ]</span></span></code></pre></div>
<p>In this example dataset the number of states in the state space is
the product of the number of classes in each stratifying variable, that
is <span class="math inline">\(3*2*2*15*35 = 6300\)</span>.</p>
</div>
<div id="prior" class="section level4">
<h4>Prior</h4>
<p>The prior in <code>estimatetransprobs</code> works by adding one
observation to the pair data for each starting state. The
<code>efdm</code> has a few standard prior choices.</p>
<ul>
<li><code>prior_grow(variable)</code> grows <code>variable</code> by one
class.</li>
<li><code>&quot;nochange&quot;</code>, forest state is not changed</li>
<li><code>&quot;uninformative&quot;</code>, an observation with tiny weight is
added to every possible target state.</li>
</ul>
<p>For the no management activity we are using
<code>prior_grow(&quot;age&quot;)</code> stating that there is always at least one
observation where the age grows by one class but the volume is not
changing.</p>
</div>
<div id="estimation" class="section level4">
<h4>Estimation</h4>
<p>Now we are ready to estimate the transition probabilities for no
management</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>transprobs_noman <span class="ot">&lt;-</span> <span class="fu">estimatetransprobs</span>(<span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>), <span class="co"># the dynamic variables of the activity</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                     example<span class="sc">$</span>noman_pairs,  <span class="co"># pair data for no management</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                     <span class="at">statespace=</span>statespace,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                     <span class="at">factors=</span><span class="fu">c</span>(<span class="st">&quot;soil&quot;</span>), <span class="co"># Information for different soil types</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                                        <span class="co"># is used with smaller weight</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                     <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;region&quot;</span>,<span class="st">&quot;sp&quot;</span>), <span class="co"># Separate estimation for each</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                                          <span class="co"># region and species</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                     <span class="at">prior=</span><span class="fu">prior_grow</span>(<span class="st">&quot;age&quot;</span>))</span></code></pre></div>
<p>and to define the activity <code>noman</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>noman <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;noman&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>), transprobs_noman)</span></code></pre></div>
<p>The resulting transition probabilities look like</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>transprobs_noman <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">arrange</span>(vol0, age0, soil, region, sp, vol1, age1)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt;   vol0 age0    soil region    sp vol1 age1        prob</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; 1    1    1 Mineral Middle other    1    2 0.629107981</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; 2    1    1 Mineral Middle other    2    2 0.145539906</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; 3    1    1 Mineral Middle other    3    2 0.122065728</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; 4    1    1 Mineral Middle other    4    2 0.089201878</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 5    1    1 Mineral Middle other    5    2 0.009389671</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 6    1    1 Mineral Middle other    6    2 0.004694836</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 13180 rows ]</span></span></code></pre></div>
</div>
</div>
</div>
<div id="thinning" class="section level2">
<h2>Thinning</h2>
<p>We use exactly the same procedure for thinning that we used for no
management. The only differences are the activity name and the pair data
used.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>transprobs_thin <span class="ot">&lt;-</span> <span class="fu">estimatetransprobs</span>(<span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>),</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                     example<span class="sc">$</span>thin_pairs, <span class="co"># pair data for thinning</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                     <span class="at">statespace=</span>statespace,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                     <span class="at">factors=</span><span class="fu">c</span>(<span class="st">&quot;soil&quot;</span>),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                     <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;region&quot;</span>,<span class="st">&quot;sp&quot;</span>),</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                     <span class="at">prior=</span><span class="fu">prior_grow</span>(<span class="st">&quot;age&quot;</span>))</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>thin <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;thin&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>), transprobs_thin)</span></code></pre></div>
</div>
</div>
<div id="scenario-1" class="section level1">
<h1>Scenario 1</h1>
<p>EFDM is an area based model. The initial state of the scenario is a
<code>data.frame</code> where for each state there is an
<code>area</code> (zeros may be omitted)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>state0 <span class="ot">&lt;-</span> example<span class="sc">$</span>initial_state</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>state0</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt;   region    soil     sp vol age       area</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; 1  South Mineral  other   1   1  73518.749</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; 2 Middle Mineral  other   1   1 105532.353</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; 3  North Mineral  other   1   1  49583.432</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; 4  South    Peat  other   1   1  15035.772</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; 5 Middle    Peat  other   1   1  33996.388</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; 6  North    Peat  other   1   1   2039.203</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; 7  South Mineral spruce   1   1 186533.582</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; 8 Middle Mineral spruce   1   1  63984.635</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 3271 rows ]</span></span></code></pre></div>
<p>Next, we run the EFDM scenario for 20 time steps (100 years) starting
with initial state <code>state0</code>, activity probabilities
<code>actprob</code> and a list of activities.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>activities <span class="ot">&lt;-</span> <span class="fu">list</span>(noman, thin, ff)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>states1 <span class="ot">&lt;-</span> <span class="fu">runEFDM</span>(state0, actprob, activities, <span class="dv">20</span>)</span></code></pre></div>
<p><code>runEFDM</code> produces a <code>data.frame</code> of areas
allocated to each activity at each time step.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>states1 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">arrange</span>(soil, region, sp, vol, age, time, activity)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt;      soil region    sp vol age         area activity time</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; 1 Mineral Middle other   1   1    105.53235       ff    0</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; 2 Mineral Middle other   1   1 101627.65637    noman    0</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; 3 Mineral Middle other   1   1   3799.16472     thin    0</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; 4 Mineral Middle other   1   1     99.11577       ff    1</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; 5 Mineral Middle other   1   1  95448.48821    noman    1</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; 6 Mineral Middle other   1   1   3568.16778     thin    1</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 209007 rows ]</span></span></code></pre></div>
<div id="analysing-results" class="section level2">
<h2>Analysing results</h2>
<div id="result-coefficients" class="section level3">
<h3>Result coefficients</h3>
<p>Using so called result coefficients is a way to obtain results with
respect to other forest properties than area. In this scenario we have
growing stock volume, drain and harvest income as result variables.</p>
<p>The volume coefficients convert volume class <code>vol</code> and
dominant species <code>sp</code> into growing stock volume
<code>volume</code> (m3/ha) in four tree species groups
(<code>species</code>): pine, spruce, broadleaves and all. The volume
coefficients were estimated for the classes based on the species
composition in the forest inventory data as class averages.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>example<span class="sc">$</span>vol_coef <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">arrange</span>(vol, sp, species)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;    vol     sp   species     volume</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; 1    1  other       all 0.50632300</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; 2    1  other broadleaf 0.12501893</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; 3    1  other      pine 0.30152225</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; 4    1  other    spruce 0.07978181</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; 5    1 spruce       all 1.20000000</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; 6    1 spruce broadleaf 0.37598659</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; 7    1 spruce      pine 0.09533751</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; 8    1 spruce    spruce 0.72867590</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; 9    2  other       all 3.39429400</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; 10   2  other broadleaf 0.74911648</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; 11   2  other      pine 2.16464343</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; 12   2  other    spruce 0.48053409</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 108 rows ]</span></span></code></pre></div>
<p>Drain is the harvest accumulation which is linked to management
activities (activity), and separated by the volume class (vol) and
dominant species (sp). It was also estimated from the observed changes
in the forest inventory data as class averages. The drain is given as m3
per ha (drain) and timber assortment (assort): pulp/saw wood.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>example<span class="sc">$</span>drain_coef <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>vol, sp, assort, activity)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt;    vol     sp     drain assort activity</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; 1   15  other 203.57043   pulp       ff</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; 2   15  other  61.07113   pulp     thin</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; 3   15  other 197.54969    saw       ff</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; 4   15  other  59.26491    saw     thin</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; 5   15 spruce 165.51780   pulp       ff</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; 6   15 spruce  49.65534   pulp     thin</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; 7   15 spruce 318.13899    saw       ff</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; 8   15 spruce  95.44170    saw     thin</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; 9   14  other 172.94581   pulp       ff</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; 10  14  other  51.88374   pulp     thin</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 110 rows ]</span></span></code></pre></div>
<p>Income is loosely based on the actual statistics of Finnish timber
assortment prices over last years in unit eur/m3.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>example<span class="sc">$</span>income_coef</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt;   assort activity euro</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; 1    saw       ff   56</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; 2    saw     thin   44</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; 3   pulp       ff   20</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; 4   pulp     thin   15</span></span></code></pre></div>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<p>Simulation timesteps are mutated to mid-years of simulation steps
(the simulation begins from year 2016):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>states1 <span class="ot">&lt;-</span> states1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(<span class="dv">2016</span> <span class="sc">+</span> time<span class="sc">*</span><span class="dv">5</span>))</span></code></pre></div>
<p>Growing stock volume is estimated by merging the area distribution by
simulation steps (states1) and volume coefficients. The total growing
stock volume (m3) is a result of multiplication of area (ha) and
coefficient (m3/ha). Finally the result is visualized in a figure.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>volume <span class="ot">&lt;-</span> <span class="fu">merge</span>(states1, example<span class="sc">$</span>vol_coef) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">volume=</span>area<span class="sc">*</span>volume) <span class="sc">%&gt;%</span> <span class="co">#area is multiplied with m3/ha volume the get total volume in m3</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">!=</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">ggplot</span>(volume) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">weight=</span>volume<span class="sc">/</span><span class="dv">1000000000</span>, <span class="at">fill=</span>species)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="cn">NULL</span>,<span class="at">title=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Growing stock, bil.&quot;</span>,m<span class="sc">^</span><span class="dv">3</span>)), <span class="at">x=</span><span class="st">&quot;Year&quot;</span>, <span class="at">fill=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Estimating age distribution does not require result coefficients.
However, the age classes are defined for 50-year classes instead of
original 5-year classes, and then plotted for only three time steps:
years 2016, 2066 and 2116.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>states1<span class="sc">$</span>ageclass <span class="ot">&lt;-</span> <span class="fu">cut</span>(states1<span class="sc">$</span>age, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">35</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>                        <span class="co">#labels=c(&quot;0-50&quot;,&quot;51-100&quot;,&quot;101-150&quot;,&quot;150+&quot;))</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                        <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;-50&quot;</span>,<span class="st">&quot;-100&quot;</span>,<span class="st">&quot;-150&quot;</span>,<span class="st">&quot;150+&quot;</span>))</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>states1<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">factor</span>(states1<span class="sc">$</span>region, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;South&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;North&quot;</span>))</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(states1, time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2016</span>,<span class="dv">2066</span>,<span class="dv">2116</span>))) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>ageclass, <span class="at">weight=</span>area<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">fill=</span>region)) <span class="sc">+</span>  </span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols=</span><span class="fu">vars</span>(time)) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="cn">NULL</span>, <span class="at">title=</span><span class="st">&quot;Area, mill.ha&quot;</span>, <span class="at">x=</span><span class="st">&quot;Ageclass&quot;</span>, <span class="at">fill=</span><span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Income is estimated by first converting the drain (m3/ha) into income
(eur/ha). Then multiplication with area (ha) gives the euros.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>euro <span class="ot">&lt;-</span> <span class="fu">merge</span>(example<span class="sc">$</span>drain_coef, example<span class="sc">$</span>income_coef) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">euro =</span> euro<span class="sc">*</span>drain)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>removal <span class="ot">&lt;-</span> <span class="fu">merge</span>(states1, euro) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">income=</span>euro<span class="sc">*</span>area)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(removal,<span class="sc">!</span>time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2116</span>))) <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">weight=</span>income<span class="sc">/</span><span class="dv">5000000000</span>, <span class="at">fill=</span>assort)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="cn">NULL</span>,<span class="at">title =</span> <span class="st">&quot;Income, bil.€/year&quot;</span>, <span class="at">x=</span><span class="st">&quot;5-year intervals&quot;</span>, <span class="at">fill=</span><span class="cn">NULL</span> ) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="scenario-2" class="section level1">
<h1>Scenario 2</h1>
<p>In this example the tree species changes after final felling.
Therefore we redefine final felling activity taking into account in
addition to volume and age also the dominant species. The change
probability depends on region and dominant species. Volume and age act
as before. They move to the smallest classes (vol1=1 and age1=1).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>transprobs_ff_age_species <span class="ot">&lt;-</span> statespace <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">vol0=</span>vol, <span class="at">age0=</span>age, <span class="at">sp0=</span>sp, region) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  unique <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">group_by</span>(region, sp0, vol0, age0) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">data.frame</span>(<span class="at">vol1=</span><span class="dv">1</span>, <span class="at">age1=</span><span class="dv">1</span>, <span class="at">sp1=</span><span class="fu">c</span>(<span class="st">&#39;other&#39;</span>,<span class="st">&#39;spruce&#39;</span>),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>                       <span class="at">prob=</span><span class="fu">case_when</span>(</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>                         sp0<span class="sc">==</span><span class="st">&#39;other&#39;</span> <span class="sc">&amp;&amp;</span> region<span class="sc">==</span><span class="st">&#39;South&#39;</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>                         sp0<span class="sc">==</span><span class="st">&#39;other&#39;</span> <span class="sc">&amp;&amp;</span> region<span class="sc">==</span><span class="st">&#39;Middle&#39;</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>                         sp0<span class="sc">==</span><span class="st">&#39;other&#39;</span> <span class="sc">&amp;&amp;</span> region<span class="sc">==</span><span class="st">&#39;North&#39;</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>), <span class="co">#in other dominated forest</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>                                        <span class="co"># in northern boreal vegetation zone 20% of final felled area</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>                                        <span class="co"># change to spruce dominated forest</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>                         sp0<span class="sc">==</span><span class="st">&#39;spruce&#39;</span> <span class="sc">&amp;&amp;</span> region<span class="sc">==</span><span class="st">&#39;South&#39;</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>),</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>                         sp0<span class="sc">==</span><span class="st">&#39;spruce&#39;</span> <span class="sc">&amp;&amp;</span> region<span class="sc">==</span><span class="st">&#39;Middle&#39;</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>),</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>                         sp0<span class="sc">==</span><span class="st">&#39;spruce&#39;</span> <span class="sc">&amp;&amp;</span> region<span class="sc">==</span><span class="st">&#39;North&#39;</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))))</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt; dplyr 1.1.0.</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `reframe()` instead.</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt;   always returns an ungrouped data frame and adjust accordingly.</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; generated.</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;region&#39;, &#39;sp0&#39;, &#39;vol0&#39;, &#39;age0&#39;. You can</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>ff_age_species <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;ff&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>), transprobs_ff_age_species)</span></code></pre></div>
<p>The list of activities includes the same noman and thin as in
Scenario 1, and the above defined final felling. The same initial state
as in Scenario 1 is run with the new list of activities and stored in
variable states2.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>activities2 <span class="ot">&lt;-</span> <span class="fu">list</span>(noman, thin, ff_age_species)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>states2 <span class="ot">&lt;-</span> <span class="fu">runEFDM</span>(state0, actprob, activities2, <span class="dv">20</span>)</span></code></pre></div>
<p>The proportion of spruce dominated forest area is estimated for time
steps 0, 10 and 20 (years 2016, 2066 and 2116). And the result is
presented by the vegetation zones as a map.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Compute proportion of spruces in each time and region</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>prop_spruces <span class="ot">&lt;-</span> states2 <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="fu">group_by</span>(region, time) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">proportion =</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">sum</span>((sp<span class="sc">==</span><span class="st">&quot;spruce&quot;</span>)<span class="sc">*</span>area)<span class="sc">/</span><span class="fu">sum</span>(area)) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="dv">2016</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>time)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;region&#39;. You can override using the</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; `.groups` argument.</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co"># Add bio-geographical regions (MetsaKasvVyoh provided in efdm package) to the data</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>prop_spruces <span class="ot">&lt;-</span> <span class="fu">merge</span>(MetsaKasvVyoh, prop_spruces)</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>prop_spruces <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill=</span>proportion)) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(time)) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;forestgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&quot;Proportion&quot;</span> ,<span class="at">title=</span><span class="st">&quot;Proportion of spruce dominated forests, %&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colourbar</span>(<span class="at">frame.colour =</span> <span class="st">&quot;grey20&quot;</span>,<span class="at">ticks.colour =</span> <span class="st">&quot;grey20&quot;</span>)) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The map provided by: Finnish Environment Institute</p>
</div>
<div id="scenario-3---land-use-changes" class="section level1">
<h1>Scenario 3 - Land use changes</h1>
<p>First we add two land use classes to the statespace. Agriculture is
stratified according to region and soil type, while other land use is
only stratified according to region.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>statespace3 <span class="ot">&lt;-</span> statespace</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>statespace3<span class="sc">$</span>landuse <span class="ot">&lt;-</span> <span class="st">&quot;forest&quot;</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>agriculture <span class="ot">&lt;-</span> <span class="fu">unique</span>(statespace3 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp=</span><span class="dv">0</span>, <span class="at">vol=</span><span class="dv">0</span>, <span class="at">age=</span><span class="dv">0</span>, <span class="at">landuse=</span><span class="st">&quot;agriculture&quot;</span>))</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>other <span class="ot">&lt;-</span> <span class="fu">unique</span>(statespace3 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">soil=</span><span class="dv">0</span>, <span class="at">sp=</span><span class="dv">0</span>, <span class="at">vol=</span><span class="dv">0</span>, <span class="at">age=</span><span class="dv">0</span>, <span class="at">landuse=</span><span class="st">&quot;other&quot;</span>))</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>statespace3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(statespace3, agriculture, other)</span></code></pre></div>
<p>We use separate activities for deforestation to each land use class.
Variables (vol, age, sp) not used by the agriculture are set to 0. Soil
type and region are not changing as a result of deforestation to
agriculture.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>transprobs_defor_to_agri <span class="ot">&lt;-</span> statespace3 <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="fu">filter</span>(landuse<span class="sc">==</span><span class="st">&quot;forest&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">vol0=</span>vol, <span class="at">age0=</span>age, <span class="at">sp0=</span>sp,<span class="at">landuse0=</span>landuse) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  unique <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vol1=</span><span class="dv">0</span>, <span class="at">age1=</span><span class="dv">0</span>, <span class="at">sp1=</span><span class="dv">0</span>, <span class="at">landuse1=</span><span class="st">&quot;agriculture&quot;</span>, <span class="at">prob=</span><span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>defor_to_agri <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;defor_to_agri&quot;</span>,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>                                 <span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;landuse&quot;</span>),</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>                                 transprobs_defor_to_agri)</span></code></pre></div>
<p>Deforestation to other land use also changes soil type to 0.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>transprobs_defor_to_other <span class="ot">&lt;-</span> statespace3 <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="fu">filter</span>(landuse<span class="sc">==</span><span class="st">&quot;forest&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">soil0=</span>soil, <span class="at">vol0=</span>vol, <span class="at">age0=</span>age, <span class="at">sp0=</span>sp,<span class="at">landuse0=</span>landuse) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  unique <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">soil1=</span><span class="dv">0</span>, <span class="at">vol1=</span><span class="dv">0</span>, <span class="at">age1=</span><span class="dv">0</span>, <span class="at">sp1=</span><span class="dv">0</span>, <span class="at">landuse1=</span><span class="st">&quot;other&quot;</span>, <span class="at">prob=</span><span class="dv">1</span>)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>defor_to_other <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;defor_to_other&quot;</span>,</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="st">&quot;soil&quot;</span>, <span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;landuse&quot;</span>),</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>                                  transprobs_defor_to_other)</span></code></pre></div>
<p>Afforestation only applies to agriculture. Volume and age classes
start from 1 and the area is split evenly to spruce and other
species.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>transprobs_aff <span class="ot">&lt;-</span> statespace3 <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">filter</span>(landuse<span class="sc">==</span><span class="st">&quot;agriculture&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">select</span>(soil, <span class="at">vol0=</span>vol, <span class="at">age0=</span>age, region, <span class="at">sp0=</span>sp, <span class="at">landuse0=</span>landuse) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vol1=</span><span class="dv">1</span>, <span class="at">age1=</span><span class="dv">1</span>, <span class="at">sp1=</span><span class="st">&quot;other&quot;</span>, <span class="at">landuse1=</span><span class="st">&quot;forest&quot;</span>, <span class="at">prob=</span><span class="dv">1</span>)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>transprobs_aff <span class="ot">&lt;-</span> <span class="fu">rbind</span>(transprobs_aff <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp1=</span><span class="st">&quot;spruce&quot;</span>, <span class="at">prob=</span><span class="fl">0.5</span>),</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>                        transprobs_aff <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp1=</span><span class="st">&quot;other&quot;</span>, <span class="at">prob=</span><span class="fl">0.5</span>))</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>affor <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;affor&quot;</span>,</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">&quot;vol&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;landuse&quot;</span>),</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>                         transprobs_aff)</span></code></pre></div>
<p>A donothing activity is used for non-forest land uses, when there is
nothing forestry related going on.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>donothing <span class="ot">&lt;-</span> <span class="fu">define_activity</span>(<span class="st">&quot;donothing&quot;</span>, <span class="fu">character</span>())</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>activities3 <span class="ot">&lt;-</span> <span class="fu">list</span>(noman, thin, ff, defor_to_other, defor_to_agri, affor, donothing)</span></code></pre></div>
<p>adding land use information to state</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>state03 <span class="ot">&lt;-</span> state0</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>state03<span class="sc">$</span>landuse <span class="ot">&lt;-</span> <span class="st">&quot;forest&quot;</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>state03 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(state03,  agriculture <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">area=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1552000</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">997000</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">76000</span><span class="sc">/</span><span class="dv">2</span>),<span class="at">each=</span><span class="dv">2</span>)),</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>                 other <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">area=</span><span class="fu">c</span>(<span class="dv">721000</span>,<span class="dv">507000</span>,<span class="dv">112000</span>)))</span></code></pre></div>
<p>Activity probabilities for new land uses</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>actprob3 <span class="ot">&lt;-</span> actprob</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>actprob3<span class="sc">$</span>landuse <span class="ot">&lt;-</span> <span class="st">&quot;forest&quot;</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co"># Define probabilities for new activities</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>actprob3<span class="sc">$</span>defor_to_other <span class="ot">&lt;-</span> <span class="fl">0.0002</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>actprob3<span class="sc">$</span>defor_to_agri <span class="ot">&lt;-</span> <span class="fl">0.00025</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>actprob3<span class="sc">$</span>affor <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>actprob3<span class="sc">$</span>donothing <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co"># Normalise probabilities after adding new activities</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>actnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;noman&quot;</span>, <span class="st">&quot;thin&quot;</span>, <span class="st">&quot;ff&quot;</span>, <span class="st">&quot;defor_to_other&quot;</span>, <span class="st">&quot;defor_to_agri&quot;</span>, <span class="st">&quot;affor&quot;</span>, <span class="st">&quot;donothing&quot;</span>)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>actprob3[actnames] <span class="ot">&lt;-</span> actprob3[actnames]<span class="sc">/</span><span class="fu">rowSums</span>(actprob3[actnames])</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co"># Define activity probabilities also for agriculture and other land uses</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>actprob3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(actprob3, </span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>        agriculture <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">thin=</span><span class="dv">0</span>, <span class="at">ff=</span><span class="dv">0</span>, <span class="at">noman=</span><span class="dv">0</span>, <span class="at">defor_to_other=</span><span class="dv">0</span>, <span class="at">defor_to_agri=</span><span class="dv">0</span>, <span class="at">affor=</span><span class="fl">0.0005</span>, <span class="at">donothing=</span><span class="fl">0.9995</span>),</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>        other <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">thin=</span><span class="dv">0</span>, <span class="at">ff=</span><span class="dv">0</span>, <span class="at">noman=</span><span class="dv">0</span>, <span class="at">defor_to_other=</span><span class="dv">0</span>, <span class="at">defor_to_agri=</span><span class="dv">0</span>, <span class="at">affor=</span><span class="dv">0</span>, <span class="at">donothing=</span><span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>states3 <span class="ot">&lt;-</span> <span class="fu">runEFDM</span>(state03, actprob3, activities3, <span class="dv">20</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co">#pie charts of land use areas</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>LUareas <span class="ot">&lt;-</span> states3 <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="fu">group_by</span>(time, landuse) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">area =</span> <span class="fu">sum</span>(area)) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;time&#39;. You can override using the</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">#&gt; `.groups` argument.</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>LUareas <span class="ot">&lt;-</span> LUareas <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">2016</span>,<span class="dv">2116</span>,<span class="dv">5</span>)))</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>totalarea <span class="ot">&lt;-</span> <span class="fu">sum</span>(state03<span class="sc">$</span>area)</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>LUareas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2016&quot;</span>,<span class="st">&quot;2066&quot;</span>,<span class="st">&quot;2116&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> area<span class="sc">/</span>totalarea) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>,<span class="at">y=</span>area, <span class="at">fill=</span>landuse), <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(time)) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="st">&quot;Land use&quot;</span>, <span class="at">x=</span><span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>,<span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.33</span>, <span class="fl">0.95</span>), <span class="dv">3</span>), <span class="at">label =</span> <span class="fu">round</span>(area<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)),</span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>            <span class="at">nudge_x=</span><span class="fl">0.25</span>, <span class="at">size=</span><span class="fl">2.25</span>,</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>            <span class="at">color=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;grey20&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;white&quot;</span>), <span class="dv">3</span>), <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
